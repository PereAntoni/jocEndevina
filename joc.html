<html>
    <head>
        <meta charset="utf-8">
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <meta name="description" content="Joc nadalenc 2020. IES Mossèn Alcover.">
<meta property="og:description" content="Joc nadalenc 2020. IES Mossèn Alcover.">
<meta property="og:type" content="website">
<meta property="og:locale" content="es_ca">
<meta property="og:title" content="Joc nadalenc-IES Mossèn Alcover.">
<meta property="og:site_name" content="IES Mossèn Alcover.">


<meta property="og:url" content="http://api.iesmossenalcover.cat/jocProfes/">
<meta property="og:image" content="https://i0.wp.com/iesmossenalcover.cat/home/wp-content/uploads/2020/09/cropped-LOGO-MOSSE%CC%80N-2.jpg">
<meta property="og:image:secure_url" content="https://i0.wp.com/iesmossenalcover.cat/home/wp-content/uploads/2020/09/cropped-LOGO-MOSSE%CC%80N-2.jpg">
<meta property="og:image:type" content="image/jpg">
<meta property="og:image:width" content="300">
<meta property="og:image:height" content="300">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
   <link    rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>



    <style>
        .fitxa {
            padding-top:10px;
            padding-bottom:10px;
       }
    .poema {
        white-space: pre-wrap;
        white-space: -moz-pre-wrap;
        white-space: -o-pre-wrap;
        
    }
.button {
	display: inline-block;
	min-width:100px;
	padding: 15px 20px;
	text-decoration: none;
	color: #fff;
	background: red;
	outline: none;
	border-radius: 15px;
	position: relative;
    margin-top:3vh;
}

.button::before {
	content: '';
	display: block;
	position: absolute;
	top: -7px;
	left: -3px;
	right: 0;
	height: 23px;
	background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAXCAYAAACS5bYWAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABFpJREFUeNrUV0tIo1cUvpkYjQ4xxSA6DxuNqG0dtaUKOgs3s6i0dFd3pSsXdjeIixakiGA34sZuXCkoONLFwJTK4GMYLYXg29gatTpiXurkbd7vv9/5ub+IxuhA7eiFQ5Kbc8/57ne/e87/ywRBYLdl3GG3aNwqsLJ0k0tLS+fmcnNzWUVFBVMoFGx2djarvLxcm5OTw+bm5iytra2xc4ExNjY27iqVyvvwK6CpeDzuCYVC1urq6qDA9UcfPp+PHR4esmAwKK6tr68/l5/8rgQ2Ozub1dbWyiYmJooaGxt/VqvV38jlchX9l0qlwoFA4DWS/RKLxRxFRUVf5+XlPcaaT2AP0sVPJBL2SCRiAPBpu93+vKamZo/Ae71eZjabWV1dXVqw7CKwp43ksrCw8Bhg7MJ/PLDZ5PHx8cz29vYT5JGD/bSYLgTrcDgYdk6siSc6NjZWDaAe4ZoHQL+cmZnRpZPnhWDpD8kw7uKo9ML/NMCsd2tr61vkzboMrEyv138M7TyLRqMWMBsX3sMgaZhMpp+AR5EJrCocDpuEGzKg4x8khs+CVWxubvZfR9JkMik4nU7BarUKLpeLmLsKuwIqTLynp4fqmIzASrqQT09Pf1VVVfX0KsWZ6uHBwQHTaDSsoKAgo6/H4xHLEcrVyRwuEisrKzs5XrrIVAVwiUVDKRRrL+YI32ewdVhMApuHWvcj6vids6J2u90MF4yBHUZNgKoEBaRBQalJqFSqtJfUYrGIlQX+ydXVVTN+u0tKSjQNDQ1axJVl2iTypebn55d7e3v/kqoDgZU1NTU9LCws/Py0M+2ekuGincxJ3yF+18jIyHJLS0slQJUWFxczrBeBE0vE5tHRkbixlZWVfSR8gTX/0P5gH7S1tX3Z3t7+BW8qAvwSfr8/jA0EIRM/qoFtampqbW9vTw+XA+ojUruVd3Z2tvb19T2TQFEim81GgVJoCvvj4+NLOJZgaWmpemdn5y3a6BbcnJDAw8HBwac6ne6eqCW5XDwB3qVSqM9/DAwMUNy/eVLabT7sI25qwgujThCBhWE+mAt2yNc4SQKSZrOQQE1HS22VJkmPAGTr7+//fX19fRk+Zgq0trbGeFAKEAQT98BSqKOj47vm5uaa/Px8JeIk4GcaHh6eWlxcfAU/A8xG67BxAX3fwdcbYUpSDJ06Z49Ak8ZC3OL8f3YiA4PBYKdLQ2AJ9OTk5GpXV9cQiCVh79M94QtlPLDUE/1gPNrd3f0W33W4cBoco48zQuy/IZYAMnGqlSc4c66L9JruQUaSARXeT8HGKzxAqFBekni6+h46+pMzGiJGMgTOJh1yU/KNEGDvZWvfBawkA9ppwGg0mrRa7SOI2g+gxOgbJIpdFpj72PnxSnPX8vqRxTURgBQWKisrH+GThOm+CtAzoK/9/Uiqq/6hoaHfdnd3jaOjo7/yY7yxbwqkWy3sQzpS2C6YirwvUJk0y7hurfyGRrnduPGvAAMASmo8wzeVwfsAAAAASUVORK5CYII=) no-repeat 0 0,
	url(data:image/png;base64,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) no-repeat 50% 0,
	url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAXCAYAAACFxybfAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAodJREFUeNrsVb1rWlEUv2pN/GqspKRSKFYXWzEloIWif0Fn6dJChQ7OQil0qd3EzcEpg0OgdHDr4CQODk7VRlLMEIVqApX4We0zflR9/Z1Ui4T34ksaaAYP/Hzc673n/M6550PG8zz73yKjn0wm83fDYDAwo9HINBrNnwOQg4MDs0ql2lQqlfdAWont7ng8Pjw+Ps44nc4G1pI9EXWaSOzt7TGO42aH5Pv7+08ajUZ0MBiUeXEZd7vdL5VK5fX29rZ+5tQiEmdxKrlcjsEYczgcynK5/BKKv/IXFNz/XiqVXkHdjUuRIA9SqdRD8or/R8Ez9fr9fqHVakUR4c2z0REjIQuHw2ZcrPBXLCA0RHTezEdHjIQqkUhEr9I4HOILhQLf6/VoOUFEvDMiQiToDx1Cdz+bzZ6bUFarlel0OkkVUK/XWbvdPoVer5fh3ntsfwJ+CJ2XA4p0Op1bpBgJyxDehQQ6nQ5DZXHBYDBZq9V+EhFUndnr9drEqoc2bwJbwGPgtohuVSwWe2Gz2TZMJpNgRKi6qtUqg2EWj8dTgUDgo0KhWPN4PC70EvXOzs67fD6/S6kiRIKeZA1YJ2MiJNbdbvfTUCjkV6vVK2hcDF8GI2w0GrGTkxM2HA5PDxaLxSOfz/cWEfk81X0XIMMFgJJ/srBjCgk8IdcfuVyuZ36//7nFYtkQyAMumUzuRiKRD0jMFLa+AZOpYwqgB/ziBVqmVBKUO7eAB/R0WG/Z7XaTVqtdbTabHJL6EK2djBaBPHA0NSqpbUsiMUeEBgpF4Q5AbZrmSJ/yEWgBTaBNHl9kdkgmMUeG7qwAq9PqovceTA3zlxlgsuswyuXsGsiSxJLEkoSY/BZgAEjRodi+uBruAAAAAElFTkSuQmCC) no-repeat 100% 0;
}
body {
  background-color:  #3b83bd;
}

.foto{
    margin-top: 3vh;
    margin-bottom: 3vh;
    border-radius: 15px;
}

    </style>
    </head>
    <body class="container-fluid" ondragstart="return false;" oncontextmenu="return false;">

    <div class="btn-block button">
        <h3>Endevina professors</h3>
        <div id="entradaDades" class="row">    
            <div class="input-group mb-3 input-group-lg col-sm-8">
                <div class="input-group-prepend"><span class="input-group-text">Email</span></div>
                <input type="email" class="form-control" id="email">
            </div>
            <div class="input-group mb-3 input-group-lg col-sm-2">    
                <button class="btn-block button" id="inicia"">Juga</button>
            </div>
        </div>
    </div> 

    <h4 id="puntuacio"></h4>

    <div id="joc"> 
        <div class="row">
            <div class="col-sm-6">      
                <img id="img1" class="img-responsive w-100 foto " src="http://aula.gimnesia.net/fotos/100.jpg">
            </div>
            <div class="col-sm-6" id="botons">
                <button id="boto0" class="btn btn-primary btn-block button" onclick="pitjat(0)">.</button>
                <button id="boto1" class="btn btn-primary btn-block button" onclick="pitjat(1)">.</button>
                <button id="boto2" class="btn btn-primary btn-block button" onclick="pitjat(2)">.</button>
                <button id="boto3" class="btn btn-primary btn-block button" onclick="pitjat(3)">.</button>
            </div>
        </div>  
    </div>
    </body>

    <script>

var especies =[];       //conté les respostes donedes per l'api
var aleatoris=[];       //conté les possibilitats de respostes a cada torn
var correcte;           //conté la resposta correcte de dins la llista anterior(aleatoris)
let nOrdre=[];          //conté la llista aleatòria per mostrar les fotos (preguntes)
let torn=0;             //guarda el torn en que ens trobam
var punts=0;            //guarda el nombre de punts que duim a la partida
var nombre=4;           //nombre de respostes per pregunta
var maxim;              //nombre de respostes existents         
var tipusJoc=1;         //tipus de joc per generar respostes (no s'usa)
var codiPartida;        //codi de la partida és un aletori que ens dona l'api
var voltes;             //nombre de voltes que es duen 
var nomJugador;         //Nom del jugador ;)

console.log("Benvingunombrelicació");
$("#inicia").click();
iniciPagina();

$(document).ready(function(){
  $(".form-check-input").click(function(){
      if($("#radio1").is(':checked')){tipusJoc=0;}
      if($("#radio2").is(':checked')){tipusJoc=1;}
      if($("#radio3").is(':checked')){tipusJoc=2;}
      if($("#radio4").is(':checked')){tipusJoc=3;}
      posaBotons();
  });
  
  $("#inicia").click(function(){
    
    $.get("http://api.iesmossenalcover.cat/profe/read.php",
    {},
    function(data,status){
        //inicia una partida llegint les repostes-preguntes
        //de l'API corresponent.
        especies = JSON.parse(JSON.stringify(data));
        punts=0;    //posa el marcador a zero
        console.log("Carregat:" + JSON.stringify(especies));
        creaPartida();//
        
        //Control de div a inici de partida.
        $("#entradaDades").hide();
        $("#joc").show();
        
        //iniciam una volta(el jugador contesta una pregunta)
        volta();

    });
  });
});

function iniciPagina(){
    $("#joc").hide(100);
    $("#entradaDades").show();
}




function mostraPuntuacions(){
    //mostra la puntuació aconseguida
    alert("Molt be " + nomJugador + " has aconseguit " + punts);
    //enviar resultats;
    enviaResultat();
    iniciPagina();
}

function anotaPuntuacio(){
    document.getElementById("puntuacio").innerHTML="Puntuació : " + punts;
    //versio 2: 
}

function posaNom(){
    //triam el numero que serà el correcte.
    correcte = Math.floor((Math.random() * nombre) + 1) - 1;
    let n= aleatoris[correcte] - 1;
    document.getElementById("r").innerHTML="Puntuació : " + punts;
    document.getElementById("nom").innerHTML=especies.records[n].nom;
}


function posaBotons(){
  let i=0;
  let tipuscombinat=false;
  
  for(let i =0;i<nombre;i++){
    let c="<b>"+especies.records[aleatoris[i]].nom + "</b><br>(" + especies.records[aleatoris[i]].carrec + ")";
    document.getElementById("boto" + i).innerHTML=c;
    //document.getElementById("boto" + i).atrr("autofocus","false");
    document.getElementById("boto" + i).blur();
  }
  //if(tipuscombinat){tipusJoc=3;}
 
}
    
function pitjat(q){
    //cointrol del que s'ha endevinat
    if (correcte==q)
        {
            punts++;
            //alert("Molt bé!!");
            document.getElementById("boto"+q).classList.add('animate__animated', 'animate__bounceOutLeft');
            
        }
        else{document.getElementById("boto"+q).classList.add('animate__animated', 'animate__hinge');}
    volta();
}



function llistaAleatoris(){

    //prepara els resultats que mostrarà per pantalla
    //el vertader es correcte (global)
    //que està dins la llista nOrdre[torn]

  let llista=[];//els quatre aleatoris.
  let n=0;
  let posicioCorrecte;
    //sabem el que serà vertader;
    console.log("PosaFoto()correcte:" + correcte);
    //triam el lloc dins les respostes;
    correcte = Math.floor((Math.random() * nombre));

  while (llista.length<nombre){
    //generam el nombre
    if (correcte==llista.length)
            {llista.push(nOrdre[torn]);}
        else{
            n = Math.floor((Math.random() * maxim));
            //comprovam que no és dins la llista
            if (llista.indexOf(n)==-1){llista.push(n);}} 
  }
  //alert(llista);
  return llista;  
}

function posaFoto(){
    //triam el numero que serà el correcte.
    //correcte = Math.floor((Math.random() * nombre));
    //console.log("PosaFoto()correcte:" + correcte);
    let n= aleatoris[correcte] +1 ;
    console.log("PosaFoto()n:" + n);
    document.getElementById("img1").src="img/" + n + ".jpg";
}
function volta() {
    voltes--;
    if (voltes>-1){
        //alert("som dins aleatoris");
        anotaPuntuacio();
        aleatoris=llistaAleatoris();
        torn++;
        console.log("Llista aleatoris: " + aleatoris);
        posaFoto();
        posaBotons();}
    else{
        anotaPuntuacio();
        mostraPuntuacions();
    }  
}


function agafaEspecies(){

}

function creaPartida(){
 /*   
 //crea partida-> agafa les dades registrades del jugador 
    //(posposat PER UNA NOVA VERSIÓ)
    $.post("http://api.iesmossenalcover.cat/jocEndevina/juga.php",
        {
            //nom: document.getElementById("nom").value,
            email: document.getElementById("email").value
        },
        function(data, status){
            //alert("Data: " + data.codi + "\nStatus: " + status);
            codiPartida=data.codi;
            document.getElementById("jugador").innerHTML=document.getElementById("nom").value;
            //var dades=JSON.parse(data);
            //alert("nom:" + dades.nom);
  });   */
    voltes=especies.records.length;
    maxim=voltes;
    nOrdre=shuffle(ompleArray(voltes));//omplim ordre de joc que seguirà cada jugador.
    //alert(voltes);    
    
    //maxim=nOrdre.length;
}

function enviaResultat(){
     $.post("http://api.gimnesia.net/partida/update.php",
        {
            codi: codiPartida,
            punts: punts
        },
        function(data, status){
            mostraResultats();
            //alert("Data: " + data.codi + "\nStatus: " + status);
            //codiPartida=data.codi;
            //document.getElementById("jugador").innerHTML=document.getElementById("nom").value;
            //var dades=JSON.parse(data);
            //alert("nom:" + dades.nom);
  });

}

function mostrarResultats(){
    $.get("http://api.gimnesia.net/partida/read.php", function(data, status){
      alert("Data: " + data + "\nStatus: " + status);
    });

}


function ompleArray(l){
  let i=0;
  let a=[];
  //a.splice(0,a.length);//buidam array
  //https://stackoverflow.com/questions/1232040/how-do-i-empty-an-array-in-javascript
  for (i=0;i<l;i++){
    a.push(i);}
  //la funcio que desordena una llista 
  console.log(a);
  return a; //nOrdre=nOrdre[Math.floor(Math.random()*nOrdre.length)];
}

function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex;
  console.log("--shuffle: entra: " + array);
  // While there remain elements to shuffle...
  while (0 !== currentIndex) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    // And swap it with the current element.
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }
  console.log("--shuffle: surt: " + array);
  return array;
}
        
       
</script>
</html>
